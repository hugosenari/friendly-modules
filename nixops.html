<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>NixOps</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> About</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="hugosenari.html"><strong aria-hidden="true">2.</strong> Hugosenari</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="hlissner.html"><strong aria-hidden="true">3.</strong> hlissner</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="cocada-boa.html"><strong aria-hidden="true">4.</strong> Thiago</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="climod.html"><strong aria-hidden="true">5.</strong> Climod</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="ew.html"><strong aria-hidden="true">6.</strong> Lucas</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="marcosrdac.html"><strong aria-hidden="true">7.</strong> Marcos</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="flake-gemini.html"><strong aria-hidden="true">8.</strong> Flake Gemini</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="impermanence.html"><strong aria-hidden="true">9.</strong> Impermanence</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="impermanence-hm.html"><strong aria-hidden="true">9.1.</strong> Impermanence HM</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="kubenix.html"><strong aria-hidden="true">10.</strong> KubeNix</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixops.html" class="active"><strong aria-hidden="true">11.</strong> NixOps</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixops-aws.html"><strong aria-hidden="true">12.</strong> NixOps AWS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="nixops-aws-data.html"><strong aria-hidden="true">12.1.</strong> data</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpn-connection.html"><strong aria-hidden="true">12.2.</strong> vpn-connection</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpn-connection-route.html"><strong aria-hidden="true">12.3.</strong> vpn-connection-route</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpn-gateway.html"><strong aria-hidden="true">12.4.</strong> vpn-gateway</a></li><li class="chapter-item expanded "><a href="nixops-aws-cloudwatch-log-group.html"><strong aria-hidden="true">12.5.</strong> cloudwatch-log-group</a></li><li class="chapter-item expanded "><a href="nixops-aws-cloudwatch-log-stream.html"><strong aria-hidden="true">12.6.</strong> cloudwatch-log-stream</a></li><li class="chapter-item expanded "><a href="nixops-aws-ec2-keypair.html"><strong aria-hidden="true">12.7.</strong> ec2-keypair</a></li><li class="chapter-item expanded "><a href="nixops-aws-ec2-placement.html"><strong aria-hidden="true">12.8.</strong> ec2-placement</a></li><li class="chapter-item expanded "><a href="nixops-aws-ec2-rds-dbinstance.html"><strong aria-hidden="true">12.9.</strong> ec2-rds-dbinstance</a></li><li class="chapter-item expanded "><a href="nixops-aws-ec2-rds-dbsecurity.html"><strong aria-hidden="true">12.10.</strong> ec2-rds-dbsecurity</a></li><li class="chapter-item expanded "><a href="nixops-aws-ec2-security.html"><strong aria-hidden="true">12.11.</strong> ec2-security</a></li><li class="chapter-item expanded "><a href="nixops-aws-eslatic-file-system.html"><strong aria-hidden="true">12.12.</strong> eslatic-file-system</a></li><li class="chapter-item expanded "><a href="nixops-aws-eslatic-file-sistem-mount.html"><strong aria-hidden="true">12.13.</strong> eslatic-file-sistem-mount</a></li><li class="chapter-item expanded "><a href="nixops-aws-eslatic-ip.html"><strong aria-hidden="true">12.14.</strong> eslatic-ip</a></li><li class="chapter-item expanded "><a href="nixops-aws-iam.html"><strong aria-hidden="true">12.15.</strong> iam</a></li><li class="chapter-item expanded "><a href="nixops-aws-rds.html"><strong aria-hidden="true">12.16.</strong> rds</a></li><li class="chapter-item expanded "><a href="nixops-aws-route53.html"><strong aria-hidden="true">12.17.</strong> route53</a></li><li class="chapter-item expanded "><a href="nixops-aws-s3.html"><strong aria-hidden="true">12.18.</strong> s3</a></li><li class="chapter-item expanded "><a href="nixops-aws-sqs.html"><strong aria-hidden="true">12.19.</strong> sqs</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc.html"><strong aria-hidden="true">12.20.</strong> vpc</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-customer.html"><strong aria-hidden="true">12.21.</strong> vpc-customer</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-dhcp.html"><strong aria-hidden="true">12.22.</strong> vpc-dhcp</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-egress.html"><strong aria-hidden="true">12.23.</strong> vpc-egress</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-endpoint.html"><strong aria-hidden="true">12.24.</strong> vpc-endpoint</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-internet.html"><strong aria-hidden="true">12.25.</strong> vpc-internet</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-nat.html"><strong aria-hidden="true">12.26.</strong> vpc-nat</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-network-interface.html"><strong aria-hidden="true">12.27.</strong> vpc-network-interface</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-network-interface-attachment.html"><strong aria-hidden="true">12.28.</strong> vpc-network-interface-attachment</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-route.html"><strong aria-hidden="true">12.29.</strong> vpc-route</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-route-table.html"><strong aria-hidden="true">12.30.</strong> vpc-route-table</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-route-table-association.html"><strong aria-hidden="true">12.31.</strong> vpc-route-table-association</a></li><li class="chapter-item expanded "><a href="nixops-aws-vpc-subnet.html"><strong aria-hidden="true">12.32.</strong> vpc-subnet</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="nixops-datadog-monitor.html"><strong aria-hidden="true">13.</strong> NixOps Datadog</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixops-digitalocean.html"><strong aria-hidden="true">14.</strong> NixOps DigitalOcean</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixops-gce.html"><strong aria-hidden="true">15.</strong> NixOps GCE</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixops-hcloud.html"><strong aria-hidden="true">16.</strong> NixOps HCloud</a></li><li class="chapter-item expanded "><a href="nixops-hcloud-volume.html"><strong aria-hidden="true">17.</strong> NixOps HCloud Volume</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixops-libvirtd.html"><strong aria-hidden="true">18.</strong> NixOps LibVirtd</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixos-firehol.html"><strong aria-hidden="true">19.</strong> NixOS-FireHOL</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="nixos-hardware.html"><strong aria-hidden="true">20.</strong> NixOS Hardware</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="nixos-hardware-asus.html"><strong aria-hidden="true">20.1.</strong> asus</a></li><li class="chapter-item expanded "><a href="nixos-hardware-surface.html"><strong aria-hidden="true">20.2.</strong> surface</a></li><li class="chapter-item expanded "><a href="nixos-hardware-raspberry.html"><strong aria-hidden="true">20.3.</strong> raspberry</a></li><li class="chapter-item expanded "><a href="nixos-hardware-system76.html"><strong aria-hidden="true">20.4.</strong> system76</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="nur-combined.html"><strong aria-hidden="true">21.</strong> NUR Combined</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="nur-combined-aasg.html"><strong aria-hidden="true">21.1.</strong> aasg</a></li><li class="chapter-item expanded "><a href="nur-combined-afreakk.html"><strong aria-hidden="true">21.2.</strong> afreakk</a></li><li class="chapter-item expanded "><a href="nur-combined-alarsyo.html"><strong aria-hidden="true">21.3.</strong> alarsyo</a></li><li class="chapter-item expanded "><a href="nur-combined-ambroisie.html"><strong aria-hidden="true">21.4.</strong> ambroisie</a></li><li class="chapter-item expanded "><a href="nur-combined-arc.html"><strong aria-hidden="true">21.5.</strong> arc</a></li><li class="chapter-item expanded "><a href="nur-combined-bb010g.html"><strong aria-hidden="true">21.6.</strong> bb010g</a></li><li class="chapter-item expanded "><a href="nur-combined-bendlas.html"><strong aria-hidden="true">21.7.</strong> bendlas</a></li><li class="chapter-item expanded "><a href="nur-combined-berbiche.html"><strong aria-hidden="true">21.8.</strong> berbiche</a></li><li class="chapter-item expanded "><a href="nur-combined-c0deaddict.html"><strong aria-hidden="true">21.9.</strong> c0deaddict</a></li><li class="chapter-item expanded "><a href="nur-combined-crazazy.html"><strong aria-hidden="true">21.10.</strong> crazazy</a></li><li class="chapter-item expanded "><a href="nur-combined-crtified.html"><strong aria-hidden="true">21.11.</strong> crtified</a></li><li class="chapter-item expanded "><a href="nur-combined-cwyc.html"><strong aria-hidden="true">21.12.</strong> cwyc</a></li><li class="chapter-item expanded "><a href="nur-combined-dawidsowa.html"><strong aria-hidden="true">21.13.</strong> dawidsowa</a></li><li class="chapter-item expanded "><a href="nur-combined-dguibert.html"><strong aria-hidden="true">21.14.</strong> dguibert</a></li><li class="chapter-item expanded "><a href="nur-combined-dtz.html"><strong aria-hidden="true">21.15.</strong> dtz</a></li><li class="chapter-item expanded "><a href="nur-combined-dukzcry.html"><strong aria-hidden="true">21.16.</strong> dukzcry</a></li><li class="chapter-item expanded "><a href="nur-combined-emmanuelrosa.html"><strong aria-hidden="true">21.17.</strong> emmanuelrosa</a></li><li class="chapter-item expanded "><a href="nur-combined-heph2.html"><strong aria-hidden="true">21.18.</strong> heph2</a></li><li class="chapter-item expanded "><a href="nur-combined-ilya-fedin.html"><strong aria-hidden="true">21.19.</strong> ilya-fedin</a></li><li class="chapter-item expanded "><a href="nur-combined-immae.html"><strong aria-hidden="true">21.20.</strong> immae</a></li><li class="chapter-item expanded "><a href="nur-combined-instantos.html"><strong aria-hidden="true">21.21.</strong> instantos</a></li><li class="chapter-item expanded "><a href="nur-combined-jbarthelmes.html"><strong aria-hidden="true">21.22.</strong> jbarthelmes</a></li><li class="chapter-item expanded "><a href="nur-combined-johnazoidberg.html"><strong aria-hidden="true">21.23.</strong> johnazoidberg</a></li><li class="chapter-item expanded "><a href="nur-combined-jomik.html"><strong aria-hidden="true">21.24.</strong> jomik</a></li><li class="chapter-item expanded "><a href="nur-combined-kampka.html"><strong aria-hidden="true">21.25.</strong> kampka</a></li><li class="chapter-item expanded "><a href="nur-combined-kapack.html"><strong aria-hidden="true">21.26.</strong> kapack</a></li><li class="chapter-item expanded "><a href="nur-combined-kira-bruneau.html"><strong aria-hidden="true">21.27.</strong> kira-bruneau</a></li><li class="chapter-item expanded "><a href="nur-combined-kolloch.html"><strong aria-hidden="true">21.28.</strong> kolloch</a></li><li class="chapter-item expanded "><a href="nur-combined-krebs.html"><strong aria-hidden="true">21.29.</strong> krebs</a></li><li class="chapter-item expanded "><a href="nur-combined-kreisys.html"><strong aria-hidden="true">21.30.</strong> kreisys</a></li><li class="chapter-item expanded "><a href="nur-combined-linyinfeng.html"><strong aria-hidden="true">21.31.</strong> linyinfeng</a></li><li class="chapter-item expanded "><a href="nur-combined-lschuermann.html"><strong aria-hidden="true">21.32.</strong> lschuermann</a></li><li class="chapter-item expanded "><a href="nur-combined-lucasew.html"><strong aria-hidden="true">21.33.</strong> lucasew</a></li><li class="chapter-item expanded "><a href="nur-combined-misterio.html"><strong aria-hidden="true">21.34.</strong> misterio</a></li><li class="chapter-item expanded "><a href="nur-combined-mmilata.html"><strong aria-hidden="true">21.35.</strong> mmilata</a></li><li class="chapter-item expanded "><a href="nur-combined-moredhel.html"><strong aria-hidden="true">21.36.</strong> moredhel</a></li><li class="chapter-item expanded "><a href="nur-combined-moredread.html"><strong aria-hidden="true">21.37.</strong> moredread</a></li><li class="chapter-item expanded "><a href="nur-combined-noneucat.html"><strong aria-hidden="true">21.38.</strong> noneucat</a></li><li class="chapter-item expanded "><a href="nur-combined-onny.html"><strong aria-hidden="true">21.39.</strong> onny</a></li><li class="chapter-item expanded "><a href="nur-combined-pamplemousse.html"><strong aria-hidden="true">21.40.</strong> pamplemousse</a></li><li class="chapter-item expanded "><a href="nur-combined-pborzenkov.html"><strong aria-hidden="true">21.41.</strong> pborzenkov</a></li><li class="chapter-item expanded "><a href="nur-combined-peel.html"><strong aria-hidden="true">21.42.</strong> peel</a></li><li class="chapter-item expanded "><a href="nur-combined-priegger.html"><strong aria-hidden="true">21.43.</strong> priegger</a></li><li class="chapter-item expanded "><a href="nur-combined-qchem.html"><strong aria-hidden="true">21.44.</strong> qchem</a></li><li class="chapter-item expanded "><a href="nur-combined-rycee.html"><strong aria-hidden="true">21.45.</strong> rycee</a></li><li class="chapter-item expanded "><a href="nur-combined-sehqlr.html"><strong aria-hidden="true">21.46.</strong> sehqlr</a></li><li class="chapter-item expanded "><a href="nur-combined-shamilton.html"><strong aria-hidden="true">21.47.</strong> shamilton</a></li><li class="chapter-item expanded "><a href="nur-combined-sikmir.html"><strong aria-hidden="true">21.48.</strong> sikmir</a></li><li class="chapter-item expanded "><a href="nur-combined-splintah.html"><strong aria-hidden="true">21.49.</strong> splintah</a></li><li class="chapter-item expanded "><a href="nur-combined-syberant.html"><strong aria-hidden="true">21.50.</strong> syberant</a></li><li class="chapter-item expanded "><a href="nur-combined-tilpner.html"><strong aria-hidden="true">21.51.</strong> tilpner</a></li><li class="chapter-item expanded "><a href="nur-combined-tukuan.html"><strong aria-hidden="true">21.52.</strong> tukuan</a></li><li class="chapter-item expanded "><a href="nur-combined-tox.html"><strong aria-hidden="true">21.53.</strong> tox</a></li><li class="chapter-item expanded "><a href="nur-combined-vdmeester.html"><strong aria-hidden="true">21.54.</strong> vdmeester</a></li><li class="chapter-item expanded "><a href="nur-combined-vroad.html"><strong aria-hidden="true">21.55.</strong> vroad</a></li><li class="chapter-item expanded "><a href="nur-combined-xeals.html"><strong aria-hidden="true">21.56.</strong> xeals</a></li><li class="chapter-item expanded "><a href="nur-combined-zeratax.html"><strong aria-hidden="true">21.57.</strong> zeratax</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="deploymentalwaysactivate"><a class="header" href="#deploymentalwaysactivate">deployment.alwaysActivate</a></h2>
<p>Always run the activation script, no matter whether the configuration
has changed (the default). This behaviour can be enforced even if it's
set to <code>false</code> using the command line option
<code>--always-activate</code> on deployment.</p>
<p>If this is set to <code>false</code>, activation is done only if
the new system profile doesn't match the previous one.</p>
<h4 id="type"><a class="header" href="#type">type</a></h4>
<p>boolean</p>
<h4 id="default"><a class="header" href="#default">default</a></h4>
<pre><code class="language-nix">{
  deployment.alwaysActivate = true;
}
</code></pre>
<h2 id="deploymentarguments"><a class="header" href="#deploymentarguments">deployment.arguments</a></h2>
<p>Attribute set representing the NixOps arguments. This is set by NixOps.</p>
<h4 id="type-1"><a class="header" href="#type-1">type</a></h4>
<p>unspecified</p>
<h2 id="deploymenthasfastconnection"><a class="header" href="#deploymenthasfastconnection">deployment.hasFastConnection</a></h2>
<p>If set to <code>true</code>, whole closure will be copied using just <code>nix-copy-closure</code>.</p>
<p>If set to <code>false</code>, closure will be copied first using binary substitution.
Additionally, any missing derivations copied with <code>nix-copy-closure</code> will be done
using <code>--gzip</code> flag.</p>
<p>Some backends set this value to <code>true</code>.</p>
<h4 id="type-2"><a class="header" href="#type-2">type</a></h4>
<p>boolean</p>
<h4 id="default-1"><a class="header" href="#default-1">default</a></h4>
<pre><code class="language-nix">{
  deployment.hasFastConnection = false;
}
</code></pre>
<h2 id="deploymentkeys"><a class="header" href="#deploymentkeys">deployment.keys</a></h2>
<p>The set of keys to be deployed to the machine.  Each attribute maps
a key name to a file that can be accessed as
<code>destDir</code>/<code>name</code>,
where <code>destDir</code> defaults to
<code>/run/keys</code>.  Thus, <code>{ password.text = &quot;foobar&quot;; }</code> causes a file
<code>destDir</code>/password<code>to be created with contents</code>foobar<code>.  The directory </code>destDir<code>is only accessible to root and the</code>keys`` group, so keep in mind
to add any users that need to have access to a particular key to this
group.</p>
<p>Each key also gets a systemd service <code>&lt;name&gt;-key.service</code>
which is active while the key is present and inactive while the key
is absent.  Thus, <code>{ password.text = &quot;foobar&quot;; }</code> gets
a <code>password-key.service</code>.</p>
<h4 id="type-3"><a class="header" href="#type-3">type</a></h4>
<p>attribute set of string or key options</p>
<h4 id="example"><a class="header" href="#example">example</a></h4>
<pre><code class="language-nix">{
  deployment.keys = {
    password = {
      text = &quot;foobar&quot;;
    };
  };
}
</code></pre>
<h4 id="default-2"><a class="header" href="#default-2">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys = {};
}
</code></pre>
<h2 id="deploymentkeysnamedestdir"><a class="header" href="#deploymentkeysnamedestdir">deployment.keys.&lt;name&gt;.destDir</a></h2>
<p>When specified, this allows changing the destDir directory of the key
file from its default value of <code>/run/keys</code>.</p>
<p>This directory will be created, its permissions changed to
<code>0750</code> and ownership to <code>root:keys</code>.</p>
<h4 id="type-4"><a class="header" href="#type-4">type</a></h4>
<p>path</p>
<h4 id="default-3"><a class="header" href="#default-3">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.destDir = &quot;/run/keys&quot;;
}
</code></pre>
<h2 id="deploymentkeysnamegroup"><a class="header" href="#deploymentkeysnamegroup">deployment.keys.&lt;name&gt;.group</a></h2>
<p>The group that will be set for the key file.</p>
<h4 id="type-5"><a class="header" href="#type-5">type</a></h4>
<p>string</p>
<h4 id="default-4"><a class="header" href="#default-4">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.group = &quot;root&quot;;
}
</code></pre>
<h2 id="deploymentkeysnamekeycommand"><a class="header" href="#deploymentkeysnamekeycommand">deployment.keys.&lt;name&gt;.keyCommand</a></h2>
<p>When non-null, output of this command run on local machine will be
deployed to the specified key on the target machine.  If the key name
is
<code>password</code> and <code>echo secrettoken</code>
is set here, the contents of the file
<code>destDir</code>/<code>password</code>
deployed will equal the output of the command <code>echo secrettoken</code>.</p>
<p>This option is especially useful when you don't want to store the secrets
inside of your NixOps deployment but rather in a well-guarded place such as an
encrypted file. Consider using nixpkgs.password-store as storage for
such sensitive secrets.</p>
<p>NOTE: Either <code>text</code>, <code>keyCommand</code> or
<code>keyFile</code> have to be set.</p>
<h4 id="type-6"><a class="header" href="#type-6">type</a></h4>
<p>null or list of string</p>
<h4 id="example-1"><a class="header" href="#example-1">example</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.keyCommand = [
    &quot;pass&quot;
    &quot;show&quot;
    &quot;secrettoken&quot;
  ];
}
</code></pre>
<h4 id="default-5"><a class="header" href="#default-5">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.keyCommand = null;
}
</code></pre>
<h2 id="deploymentkeysnamekeyfile"><a class="header" href="#deploymentkeysnamekeyfile">deployment.keys.&lt;name&gt;.keyFile</a></h2>
<p>When non-null, contents of the specified file will be deployed to the
specified key on the target machine.  If the key name is
<code>password</code> and <code>/foo/bar</code> is set
here, the contents of the file
<code>destDir</code>/<code>password</code>
deployed will be the same as local file <code>/foo/bar</code>.</p>
<p>Since no serialization/deserialization of key contents is involved, there
are no limits on that content: null bytes, invalid Unicode,
<code>/dev/random</code> output -- anything goes.</p>
<p>NOTE: Either <code>text</code>, <code>keyCommand</code> or
<code>keyFile</code> have to be set.</p>
<h4 id="type-7"><a class="header" href="#type-7">type</a></h4>
<p>null or path</p>
<h4 id="default-6"><a class="header" href="#default-6">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.keyFile = null;
}
</code></pre>
<h2 id="deploymentkeysnamename"><a class="header" href="#deploymentkeysnamename">deployment.keys.&lt;name&gt;.name</a></h2>
<p>The name of the key file.</p>
<h4 id="type-8"><a class="header" href="#type-8">type</a></h4>
<p>string</p>
<h4 id="example-2"><a class="header" href="#example-2">example</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.name = &quot;secret.txt&quot;;
}
</code></pre>
<h4 id="default-7"><a class="header" href="#default-7">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.name = &quot;‹name›&quot;;
}
</code></pre>
<h2 id="deploymentkeysnamepermissions"><a class="header" href="#deploymentkeysnamepermissions">deployment.keys.&lt;name&gt;.permissions</a></h2>
<p>The default permissions to set for the key file, needs to be in the
format accepted by <code>chmod(1)</code>.</p>
<h4 id="type-9"><a class="header" href="#type-9">type</a></h4>
<p>string</p>
<h4 id="example-3"><a class="header" href="#example-3">example</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.permissions = &quot;0640&quot;;
}
</code></pre>
<h4 id="default-8"><a class="header" href="#default-8">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.permissions = &quot;0600&quot;;
}
</code></pre>
<h2 id="deploymentkeysnametext"><a class="header" href="#deploymentkeysnametext">deployment.keys.&lt;name&gt;.text</a></h2>
<p>When non-null, this designates the text that the key should contain. So if
the key name is <code>password</code> and
<code>foobar</code> is set here, the contents of the file
<code>destDir</code>/<code>password</code>
will be <code>foobar</code>.</p>
<p>NOTE: Either <code>text</code>, <code>keyCommand</code> or
<code>keyFile</code> have to be set.</p>
<h4 id="type-10"><a class="header" href="#type-10">type</a></h4>
<p>null or string</p>
<h4 id="example-4"><a class="header" href="#example-4">example</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.text = &quot;super secret stuff&quot;;
}
</code></pre>
<h4 id="default-9"><a class="header" href="#default-9">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.text = null;
}
</code></pre>
<h2 id="deploymentkeysnameuser"><a class="header" href="#deploymentkeysnameuser">deployment.keys.&lt;name&gt;.user</a></h2>
<p>The user which will be the owner of the key file.</p>
<h4 id="type-11"><a class="header" href="#type-11">type</a></h4>
<p>string</p>
<h4 id="default-10"><a class="header" href="#default-10">default</a></h4>
<pre><code class="language-nix">{
  deployment.keys.&lt;name&gt;.user = &quot;root&quot;;
}
</code></pre>
<h2 id="deploymentname"><a class="header" href="#deploymentname">deployment.name</a></h2>
<p>The name of the NixOps deployment. This is set by NixOps.</p>
<h4 id="type-12"><a class="header" href="#type-12">type</a></h4>
<p>string</p>
<h2 id="deploymentowners"><a class="header" href="#deploymentowners">deployment.owners</a></h2>
<p>List of email addresses of the owners of the machines. Used
to send email on performing certain actions.</p>
<h4 id="type-13"><a class="header" href="#type-13">type</a></h4>
<p>list of string</p>
<h4 id="default-11"><a class="header" href="#default-11">default</a></h4>
<pre><code class="language-nix">{
  deployment.owners = [];
}
</code></pre>
<h2 id="deploymentprivilegeescalationcommand"><a class="header" href="#deploymentprivilegeescalationcommand">deployment.privilegeEscalationCommand</a></h2>
<p>A command to escalate to root privileges when using SSH as a non-root user.
This option is ignored if the <code>targetUser</code> option is set to <code>root</code>.</p>
<p>The program and its options are executed verbatim without shell.</p>
<p>It's good practice to end with &quot;--&quot; to indicate that the privilege escalation command
should stop processing command line arguments.</p>
<h4 id="type-14"><a class="header" href="#type-14">type</a></h4>
<p>list of string</p>
<h4 id="default-12"><a class="header" href="#default-12">default</a></h4>
<pre><code class="language-nix">{
  deployment.privilegeEscalationCommand = [
    &quot;sudo&quot;
    &quot;-H&quot;
    &quot;--&quot;
  ];
}
</code></pre>
<h2 id="deploymentprovisionsshkey"><a class="header" href="#deploymentprovisionsshkey">deployment.provisionSSHKey</a></h2>
<p>This option specifies whether to let NixOps provision SSH deployment keys.</p>
<p>NixOps will by default generate an SSH key, store the private key in its state file,
and add the public key to the remote host.</p>
<p>Setting this option to <code>false</code> will disable this behaviour
and rely on you to manage your own SSH keys by yourself and to ensure
that <code>ssh</code> has access to any keys it requires.</p>
<h4 id="type-15"><a class="header" href="#type-15">type</a></h4>
<p>boolean</p>
<h4 id="default-13"><a class="header" href="#default-13">default</a></h4>
<pre><code class="language-nix">{
  deployment.provisionSSHKey = true;
}
</code></pre>
<h2 id="deploymentsshoptions"><a class="header" href="#deploymentsshoptions">deployment.sshOptions</a></h2>
<p>Extra options passed to the OpenSSH client verbatim, and are not executed by a shell.</p>
<h4 id="type-16"><a class="header" href="#type-16">type</a></h4>
<p>list of string</p>
<h4 id="default-14"><a class="header" href="#default-14">default</a></h4>
<pre><code class="language-nix">{
  deployment.sshOptions = [];
}
</code></pre>
<h2 id="deploymenttargetenv"><a class="header" href="#deploymenttargetenv">deployment.targetEnv</a></h2>
<p>This option specifies the type of the environment in which the
machine is to be deployed by NixOps.</p>
<h4 id="type-17"><a class="header" href="#type-17">type</a></h4>
<p>string</p>
<h4 id="example-5"><a class="header" href="#example-5">example</a></h4>
<pre><code class="language-nix">{
  deployment.targetEnv = &quot;ec2&quot;;
}
</code></pre>
<h4 id="default-15"><a class="header" href="#default-15">default</a></h4>
<pre><code class="language-nix">{
  deployment.targetEnv = &quot;none&quot;;
}
</code></pre>
<h2 id="deploymenttargethost"><a class="header" href="#deploymenttargethost">deployment.targetHost</a></h2>
<p>This option specifies the hostname or IP address to be used by
NixOps to execute remote deployment operations.</p>
<h4 id="type-18"><a class="header" href="#type-18">type</a></h4>
<p>string</p>
<h2 id="deploymenttargetport"><a class="header" href="#deploymenttargetport">deployment.targetPort</a></h2>
<p>This option specifies the SSH port to be used by
NixOps to execute remote deployment operations.</p>
<h4 id="type-19"><a class="header" href="#type-19">type</a></h4>
<p>signed integer</p>
<h2 id="deploymenttargetuser"><a class="header" href="#deploymenttargetuser">deployment.targetUser</a></h2>
<p>The username to be used by NixOps by SSH when connecting to the
remote system.</p>
<h4 id="type-20"><a class="header" href="#type-20">type</a></h4>
<p>string</p>
<h4 id="default-16"><a class="header" href="#default-16">default</a></h4>
<pre><code class="language-nix">{
  deployment.targetUser = &quot;root&quot;;
}
</code></pre>
<h2 id="deploymentuuid"><a class="header" href="#deploymentuuid">deployment.uuid</a></h2>
<p>The UUID of the NixOps deployment. This is set by NixOps.</p>
<h4 id="type-21"><a class="header" href="#type-21">type</a></h4>
<p>string</p>
<h2 id="name"><a class="header" href="#name">name</a></h2>
<p>Name of the Command Output.</p>
<h4 id="type-22"><a class="header" href="#type-22">type</a></h4>
<p>string</p>
<h4 id="default-17"><a class="header" href="#default-17">default</a></h4>
<pre><code class="language-nix">{
  name = &quot;{name}&quot;;
}
</code></pre>
<h2 id="networkingprivateipv4"><a class="header" href="#networkingprivateipv4">networking.privateIPv4</a></h2>
<p>IPv4 address of this machine within in the logical network.
This address can be used by other machines in the logical
network to reach this machine.  However, it need not be
visible to the outside (i.e., publicly routable).</p>
<h4 id="type-23"><a class="header" href="#type-23">type</a></h4>
<p>string</p>
<h4 id="example-6"><a class="header" href="#example-6">example</a></h4>
<pre><code class="language-nix">{
  networking.privateIPv4 = &quot;10.1.2.3&quot;;
}
</code></pre>
<h2 id="networkingpublicipv4"><a class="header" href="#networkingpublicipv4">networking.publicIPv4</a></h2>
<p>Publicly routable IPv4 address of this machine.</p>
<h4 id="type-24"><a class="header" href="#type-24">type</a></h4>
<p>null or string</p>
<h4 id="example-7"><a class="header" href="#example-7">example</a></h4>
<pre><code class="language-nix">{
  networking.publicIPv4 = &quot;198.51.100.123&quot;;
}
</code></pre>
<h4 id="default-18"><a class="header" href="#default-18">default</a></h4>
<pre><code class="language-nix">{
  networking.publicIPv4 = null;
}
</code></pre>
<h2 id="networkingvpnpublickey"><a class="header" href="#networkingvpnpublickey">networking.vpnPublicKey</a></h2>
<p>Public key of the machine's VPN key (set by nixops)</p>
<h4 id="type-25"><a class="header" href="#type-25">type</a></h4>
<p>null or string</p>
<h4 id="default-19"><a class="header" href="#default-19">default</a></h4>
<pre><code class="language-nix">{
  networking.vpnPublicKey = null;
}
</code></pre>
<h2 id="privatekey"><a class="header" href="#privatekey">privateKey</a></h2>
<p>The generated private key.</p>
<h4 id="type-26"><a class="header" href="#type-26">type</a></h4>
<p>string</p>
<h4 id="default-20"><a class="header" href="#default-20">default</a></h4>
<pre><code class="language-nix">{
  privateKey = &quot;&quot;;
}
</code></pre>
<h2 id="publickey"><a class="header" href="#publickey">publicKey</a></h2>
<p>The generated public SSH key.</p>
<h4 id="type-27"><a class="header" href="#type-27">type</a></h4>
<p>string</p>
<h4 id="default-21"><a class="header" href="#default-21">default</a></h4>
<pre><code class="language-nix">{
  publicKey = &quot;&quot;;
}
</code></pre>
<h2 id="script"><a class="header" href="#script">script</a></h2>
<p>Text of a script which will produce a JSON value.
Warning: This uses shell features and is potentially dangerous.
Environment variables:
<code>$out</code> is a temp directory available for use.</p>
<h4 id="type-28"><a class="header" href="#type-28">type</a></h4>
<p>null or string</p>
<h4 id="default-22"><a class="header" href="#default-22">default</a></h4>
<pre><code class="language-nix">{
  script = null;
}
</code></pre>
<h2 id="value"><a class="header" href="#value">value</a></h2>
<p>Result of running script.</p>
<h4 id="type-29"><a class="header" href="#type-29">type</a></h4>
<p>null or string</p>
<h4 id="default-23"><a class="header" href="#default-23">default</a></h4>
<pre><code class="language-nix">{
  value = null;
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="kubenix.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="nixops-aws.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="kubenix.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="nixops-aws.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
